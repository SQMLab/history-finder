<h1>History Finder</h1>
HistoryFinder is a high-recall method-level change history tracker. It improves on state-of-the-art tools, offering a validated oracles and GUI for software evolution analysis.

# How to Use
HistoryFinder offers flexible usage options: through a Web UI for ease of use, a CLI for scripting and automation, and a Java library for seamless integration into your tools.

## Web UI

### Steps to Run the Web Interface
1. **Download the JAR file**:
    - [Download history-finder-0.0.4.jar](https://github.com/SQMLab/history-finder/releases/download/release-0.0.4/history-finder-0.0.4.jar)

2. **Download and configure the application.yml file**:
    - [Download application.yml](https://github.com/SQMLab/history-finder/releases/download/release-0.0.4/application.yml)
    - For example, show the path to the git repository in REPOSITORY_CLONE_DIRECTORY: /home/shaiful/research/github_repos/  

3. **Run the JAR file**:
   ```bash
   java -jar history-finder-0.0.4.jar
   ```
4. **Access the Web Interface**:
    - Open your browser and navigate to: [http://localhost:8080](http://localhost:8080)

---

## Command Line Interface (CLI)

### Steps to Use the CLI
1. **Download the JAR file**:
    - [Download history-finder-0.0.4.jar](https://github.com/SQMLab/history-finder/releases/download/release-0.0.4/history-finder-0.0.4.jar)
2. **Run Commands**:
   ```bash
   java -jar history-finder-0.0.4.jar <OPTIONS>
   ```

---

### Examples

#### **Generate Method History with a state-of-the-art implementation (e.g.,CodeShovel, CodeTracker, HistoryFinder )**
```bash
java -jar history-finder-0.0.4.jar \
    -command commit-trace-detail \
    -tracer-name historyFinder \
    -clone-directory ./repository \
    -repository-url https://github.com/checkstyle/checkstyle.git \
    -start-commit HEAD \
    -file src/main/java/com/puppycrawl/tools/checkstyle/Checker.java \
    -method-name fireErrors \
    -start-line 384 \
    -end-line 399 \
    -output-file ./output/trace-detail.json

```

#### **Generate Compare Method History with different state-of-the-art implementations**
```bash
java -jar history-finder-0.0.4.jar \
    -command commit-trace-comparison \
    -clone-directory ./repository \
    -repository-url https://github.com/checkstyle/checkstyle.git \
    -start-commit HEAD \
    -file src/main/java/com/puppycrawl/tools/checkstyle/Checker.java \
    -method-name fireErrors \
    -start-line 384 \
    -end-line 399 \
    -output-file ./output/commit-trace-comparison.csv

```

---
### Available Options

| **Option**                     | **Description**                                                                             |
|--------------------------------|---------------------------------------------------------------------------------------------|
| `-command <name>`              | Specify the command                                                                         |
|                                | `commit-trace-detail`: Generate method history with a tool.                                 |
|                                | `commit-trace-comparison`: Compare method history generated by different tools.             |
| `-tracer-name <tool>`          | Specify the tool.                                                                           |
|                                | `historyFinder`                                                                             |
|                                | `codeShovel`                                                                                |
|                                | `codeTracker`                                                                               |
|                                | `intelliJ` (Limited to pre-generated methods only)                                          |
|                                | `gitLineRange` (Equivalent to `git log <commit> --no-merges -L<start>,<end>:<file>`)        |
|                                | `gitFuncName` (Equivalent to `git log <commit> --no-merges -L:<funcname>:<file>`,  see [Prerequisites](#prerequisites-for-git-based-method-history-generation)))         |
| `-clone-directory <dir>`       | Directory where repositories will be cloned (e.g., `../academic`).                          |
| `-repository-url <url>`        | URL of the GitHub repository (e.g., `https://github.com/checkstyle/checkstyle.git`).        |
| `-start-commit <hash>`         | Start commit hash (e.g., `HEAD` or `119fd4fb33bef9f5c66fc950396669af842c21a3`).             |
| `-file <path>`                 | Path to the Java file (e.g., `src/main/java/com/puppycrawl/tools/checkstyle/Checker.java`). |
| `-method-name <name>`         | Name of the method (e.g., `fireErrors`).                                                    |
| `-start-line <number>`         | Start line number of the method (e.g., `384`).                                              |
| `-end-line <number>`           | End line number of the method (e.g., `399`).                                                |
| `-output-file <path>`          | Path to store the output file (e.g., `./cache/output/trace-detail.json`).                   |


## Advanced Configuration

### Tool Configuration
To customize the application, create or download the configuration file ([application.yml](https://github.com/SQMLab/history-finder/releases/download/release-0.0.3/application.yml)) and place it in the same directory as `history-finder.jar`.

| **Configuration Key**          | **Default Value** | **Description**                          |
|---------------------------------|----------------|------------------------------------------|
| `SERVER_PORT`                   | `8080`         | Port on which the server runs.           |
| `CMD_SHELL`                     | `sh`           | Default shell for git command execution. |
| `REPOSITORY_CLONE_DIRECTORY`    | `./repository` | Root directory for cloning repositories. |

### Prerequisites for Git-Based Method History Generation

To enable the `git log <commit> --no-merges -L:<funcname>:<file>` command, configure Git attributes as follows:

#### Run the following commands:
   ```bash
   touch ~/.gitattributes
   echo "*.java diff=java" >> ~/.gitattributes
   git config --global core.attributesfile ~/.gitattributes
   ```

---

# How to Contribute

Contributions are welcome! Feel free to fork the repository, submit a pull request, or open an issue to suggest improvements.

## Building and Running Project
Following tools are required for running the project:

* [Apache Maven 3.5+](https://maven.apache.org/)
* [Git](https://git-scm.com/)
* [Java 21](https://www.oracle.com/java/technologies/downloads)

Optionally following tools and services are required for visualizing commit history produced by different tools.
* [Docker](https://www.docker.com/)
* [MongoDB 5.0](https://www.mongodb.com)
* [InfluxDB 2.7.4](https://www.influxdata.com/)
* [Grafana](https://grafana.com/)

---
## Reference Study
This study compares results against multiple oracles and evaluates runtime performance relative to prior studies using the following version.   
1. [Code Shovel](https://github.com/ataraxie/codeshovel/tree/30dbe880cb6766612ddf0ee406c10e1461c902f7)
2. [Code Tracker](https://github.com/jodavimehran/code-tracker/tree/f9b4f6c5055ceeb8ab781168c6db0cccd2ca0c85)

## Notes
- Ensure the required tools (Git, Java) are installed before running the application.
- For assistance or bug reports, open an issue in the repository.


[//]: # (## License)
## License

This project is licensed under the **GNU General Public License v3.0**.

For more information, see the [LICENSE](./LICENSE) file.
