# History Finder

## Prerequisites
Following tools and frameworks are required for running the project:

* [Apache Maven 3.5+](https://maven.apache.org/)
* [Git](https://git-scm.com/)
* [Docker](https://www.docker.com/)
* [Java 8](https://www.oracle.com/java/technologies/java8.html)
* [Spring Framework](https://spring.io/)
* [MongoDB 5.0](https://www.mongodb.com)
* [InfluxDB 2.7.4](https://www.influxdata.com/)
* [Grafana](https://grafana.com/)[commit-trace-shaw.csv](..%2Frepertory%2Fcommit-trace-shaw.csv)

### Configuration

#### Git
* To ignore local.yml file change execute command 'git update-index --assume-unchanged .\src\main\resources\local.yml'
* OR  git update-index --skip-worktree src/main/resources/local.yml
* [Building a RESTful Web Service](https://spring.io/guides/gs/rest-service/)
* [Serving Web Content with Spring MVC](https://spring.io/guides/gs/serving-web-content/)
* [Building REST services with Spring](https://spring.io/guides/tutorials/rest/)
* [Accessing Data with MongoDB](https://spring.io/guides/gs/accessing-data-mongodb/)

### Docker Compose support

This project contains a Docker Compose file named `compose.yaml`.
In this file, the following services have been defined:

* mongodb: [`mongo:latest`](https://hub.docker.com/_/mongo)

---
## Reference Study
1. **Code Shovel**
   - Commit : [30dbe880cb6766612ddf0ee406c10e1461c902f7](https://github.com/ataraxie/codeshovel/tree/30dbe880cb6766612ddf0ee406c10e1461c902f7)
2. **Code Tracker**
   - Commit : [f9b4f6c5055ceeb8ab781168c6db0cccd2ca0c85](https://github.com/jodavimehran/code-tracker/tree/f9b4f6c5055ceeb8ab781168c6db0cccd2ca0c85)
## Web UI

### Steps to Run the Web Interface
1. **Download the JAR file**:
    - [Download history-finder.jar](https://github.com/shaifulcse/HistoryFinder/releases/download/release-1.06/history-finder.jar)
2. **Run the JAR file**:
   ```bash
   java -jar history-finder.jar
   ```
3. **Access the Web Interface**:
    - Open your browser and navigate to: [http://localhost:8080](http://localhost:8080)

---

## Command Line Interface (CLI)

### Steps to Use the CLI
1. **Download the JAR file**:
    - [Download history-finder.jar](https://github.com/shaifulcse/HistoryFinder/releases/download/release-1.06/history-finder.jar)
2. **Run Commands**:
   ```bash
   java -jar history-finder.jar <OPTIONS>
   ```

### Available Options

| **Option**                     | **Description**                                                                             |
|--------------------------------|---------------------------------------------------------------------------------------------|
| `-command <name>`              | Specify the command                                                                         |
|                                | `commit-trace-detail`: Generate method history with a tool.                                 |
|                                | `commit-trace-shaw`: Compare method history generated by different tools.                   |
| `-tracer-name <tool>`          | Specify the tool.                                                                           |
|                                | `historyFinder`                                                                             |
|                                | `codeShovel`                                                                                |
|                                | `codeTracker`                                                                               |
|                                | `intelliJ` (Limited to pre-generated methods only)                                          |
|                                | `gitLineRange` (Equivalent to `git log <commit> --no-merges -L<start>,<end>:<file>`)        |
|                                | `gitFuncName` (Equivalent to `git log <commit> --no-merges -L:<funcname>:<file>`)           |
| `-clone-directory <dir>`       | Directory where repositories will be cloned (e.g., `../academic`).                          |
| `-repository-url <url>`        | URL of the GitHub repository (e.g., `https://github.com/checkstyle/checkstyle.git`).        |
| `-start-commit <hash>`         | Start commit hash (e.g., `HEAD` or `119fd4fb33bef9f5c66fc950396669af842c21a3`).             |
| `-file <path>`                 | Path to the Java file (e.g., `src/main/java/com/puppycrawl/tools/checkstyle/Checker.java`). |
| `-method-name <name>`         | Name of the method (e.g., `fireErrors`).                                                    |
| `-start-line <number>`         | Start line number of the method (e.g., `384`).                                              |
| `-end-line <number>`           | End line number of the method (e.g., `399`).                                                |
| `-output-file <path>`          | Path to store the output file (e.g., `./cache/output/trace-detail.json`).                   |

---

### Examples

#### **Generate Method History with a Tool**
```bash
java -jar history-finder.jar \
    -command commit-trace-detail \
    -tracer-name historyFinder \
    -clone-directory ../academic \
    -repository-url https://github.com/checkstyle/checkstyle.git \
    -start-commit 119fd4fb33bef9f5c66fc950396669af842c21a3 \
    -file src/main/java/com/puppycrawl/tools/checkstyle/Checker.java \
    -method-name fireErrors \
    -start-line 384 \
    -end-line 399 \
    -output-file ../cache/output/trace-detail.json

```

#### **Compare Method History for Different Tools**
```bash
java -jar history-finder.jar \
    -command commit-trace-shaw \
    -clone-directory ../academic \
    -repository-url https://github.com/checkstyle/checkstyle.git \
    -start-commit 119fd4fb33bef9f5c66fc950396669af842c21a3 \
    -file src/main/java/com/puppycrawl/tools/checkstyle/Checker.java \
    -method-name fireErrors \
    -start-line 384 \
    -end-line 399 \
    -output-file ../cache/output/commit-trace-shaw.csv

```

---

## Advanced Configuration

### Application Configuration
To customize the application, create or download the configuration file ([application.yml](https://github.com/shaifulcse/HistoryFinder/releases/download/release-1.06/application.yml)) and place it in the same directory as `history-finder.jar`.

| **Configuration Key**          | **Default Value**  | **Description**                          |
|---------------------------------|--------------------|------------------------------------------|
| `SERVER_PORT`                   | `8080`             | Port on which the server runs.           |
| `CMD_SHELL`                     | `sh`               | Default shell for git command execution. |
| `REPOSITORY_CLONE_DIRECTORY`    | `../../repository` | Root directory for cloning repositories. |

### Git Log Function Name Command

To enable the `git log <commit> --no-merges -L:<funcname>:<file>` command, configure Git attributes as follows:

#### Run the following commands:
   ```bash
   touch ~/.gitattributes
   echo "*.java diff=java" >> ~/.gitattributes
   git config --global core.attributesfile ~/.gitattributes
   ```

---

## Notes
- Ensure the required tools (Git, Java) are installed before running the application.
- For assistance or bug reports, open an issue in the repository.

---

## Support and Contributions

Contributions are welcome! Feel free to fork the repository, submit a pull request, or open an issue to suggest improvements.

---

[//]: # (## License)
## License

This project is licensed under the **GNU General Public License v3.0**.

For more information, see the [LICENSE](./LICENSE) file.
